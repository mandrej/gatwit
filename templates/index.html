{% extends "base.html" %}

{% macro tweet(obj, level=0) %}
    <div id="{{ obj.id }}" class="tweet" style="margin-left: {{ '%spx' % (32 * level) }}">
        <a href="https://twitter.com/{{ obj.user.screen_name }}" target="_blank">
            <img src="{{ blank }}" style="background: url({{ obj.user.profile_image_url }})">
        </a>
        <p>
            <a class="twit" href="https://twitter.com/{{ obj.user.screen_name }}" target="_blank">
                @{{ obj.user.screen_name|default }}
            </a>
            <small>
            {{ obj.user.friends_count }} friends, {{ obj.user.followers_count }} followers,
            {{ obj.retweet_count }} retweets, {{ obj.favorite_count }} favorites
            </small>
            <br>
            <span>{{ obj.text|twitterize|urlize }}</span>
            <br>
            <small>
                {{ obj.created_at|timesince }}, {{ obj.source }},
                {% if obj.coordinates %}
                    <i class="fa fa-map-marker">
                        {{ obj.coordinates|geo_address }}
                    </i>
                {% else %}
                    {{ obj.user.location }}
                {% endif %}
            </small>
{#            <br>{% for k,v in obj.items() %}{{ k }}: {{ v|pprint }}, {% endfor %}#}
        </p>
    </div>
{% endmacro %}

{% block content %}
    {% for obj in tweets %}
        {{ tweet(obj, 0) }}
        {% if obj.thread %}
            {% for in_reply_to in obj.thread %}
                {{ tweet(in_reply_to, loop.index) }}
            {% endfor %}
        {% endif %}
    {% else %}
        <p class="noresults">No search results</p>
    {% endfor %}
{% endblock %}